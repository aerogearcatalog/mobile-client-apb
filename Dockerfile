FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG1vYmlsZS1jbGllbnQtc2VydmljZS1hcGIKZGVzY3JpcHRpb246\
IEFlcm9HZWFyIG1vYmlsZS1jbGllbnQtc2VydmljZSBTZXJ2ZXIgMgpiaW5kYWJsZTogVHJ1ZQph\
c3luYzogb3B0aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IE1vYmlsZSBDbGllbnQgU2Vy\
dmljZSAyCiAgbG9uZ0Rlc2NyaXB0aW9uOiAiQW4gQVBCIGRlcGxveWluZyB0aGUgQWVyb0dlYXIg\
bW9iaWxlLWNsaWVudC1zZXJ2aWNlIFNlcnZlciB3aXRoIHBlcnNpc3RlbnQgc3RvcmFnZSBhbmQg\
YXV0aGVudGljYXRpb24gdGhyb3VnaCBPcGVuc2hpZnQiCiAgaW1hZ2VVcmw6ICJodHRwczovL3Bi\
cy50d2ltZy5jb20vcHJvZmlsZV9pbWFnZXMvMTc5NDQ0MDAwNS9hZXJvZ2Vhcl9pY29uLTFfNDAw\
eDQwMC5wbmciCiAgZG9jdW1lbnRhdGlvblVybDogImh0dHBzOi8vZG9jcy5hZXJvZ2Vhci5vcmcv\
ZXh0ZXJuYWwvYXBiL21vYmlsZS1jbGllbnQtc2VydmljZS5odG1sIgogIHByb3ZpZGVyRGlzcGxh\
eU5hbWU6ICJSZWQgSGF0LCBJbmMuIgogIGRlcGVuZGVuY2llczoKICAgIC0gImRvY2tlci5pby9h\
ZXJvZ2Vhci9tb2JpbGUtY2xpZW50LXNlcnZpY2U6bGF0ZXN0IgogICAgLSAiZG9ja2VyLmlvL29w\
ZW5zaGlmdC9vYXV0aC1wcm94eTp2MS4xLjAiCiAgc2VydmljZU5hbWU6IG1vYmlsZS1jbGllbnQt\
c2VydmljZQogIGJpbmRpbmdzTGltaXQ6IDIKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBk\
ZXNjcmlwdGlvbjogUGVyc2lzdGVudCBkZXBsb3ltZW50IG9mIG1vYmlsZS1jbGllbnQtc2Vydmlj\
ZQogICAgZnJlZTogVHJ1ZQogICAgcGFyYW1ldGVyczogW10K"


COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb