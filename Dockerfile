FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG1vYmlsZS1jbGllbnQtc2VydmljZS1hcGIKZGVzY3JpcHRpb246
IEFlcm9HZWFyIG1vYmlsZS1jbGllbnQtc2VydmljZSBTZXJ2ZXIKYmluZGFibGU6IFRydWUKYXN5
bmM6IG9wdGlvbmFsCnRhZ3M6IAogIC0gbW9iaWxlLXNlcnZpY2UKICAtIG1vYmlsZS1jbGllbnQt
ZW5hYmxlZAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogUHVzaCBOb3RpZmljYXRpb25zCiAgbG9u
Z0Rlc2NyaXB0aW9uOiAiQW4gQVBCIGRlcGxveWluZyB0aGUgQWVyb0dlYXIgbW9iaWxlLWNsaWVu
dC1zZXJ2aWNlIFNlcnZlciB3aXRoIHBlcnNpc3RlbnQgc3RvcmFnZSBhbmQgYXV0aGVudGljYXRp
b24gdGhyb3VnaCBPcGVuc2hpZnQiCiAgaW1hZ2VVcmw6ICJodHRwczovL3Bicy50d2ltZy5jb20v
cHJvZmlsZV9pbWFnZXMvMTc5NDQ0MDAwNS9hZXJvZ2Vhcl9pY29uLTFfNDAweDQwMC5wbmciCiAg
ZG9jdW1lbnRhdGlvblVybDogImh0dHBzOi8vZG9jcy5hZXJvZ2Vhci5vcmcvZXh0ZXJuYWwvYXBi
L21vYmlsZS1jbGllbnQtc2VydmljZS5odG1sIgogIHByb3ZpZGVyRGlzcGxheU5hbWU6ICJSZWQg
SGF0LCBJbmMuIgogIGRlcGVuZGVuY2llczoKICAgIC0gImRvY2tlci5pby9hZXJvZ2Vhci9tb2Jp
bGUtY2xpZW50LXNlcnZpY2U6bGF0ZXN0IgogICAgLSAiZG9ja2VyLmlvL29wZW5zaGlmdC9vYXV0
aC1wcm94eTp2MS4xLjAiCiAgc2VydmljZU5hbWU6IG1vYmlsZS1jbGllbnQtc2VydmljZQogIGJp
bmRpbmdzTGltaXQ6IDIKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjog
UGVyc2lzdGVudCBkZXBsb3ltZW50IG9mIG1vYmlsZS1jbGllbnQtc2VydmljZQogICAgZnJlZTog
VHJ1ZQogICAgcGFyYW1ldGVyczogW10KICAgIGJpbmRfcGFyYW1ldGVyczoKICAgIC0gbmFtZTog
U0VSVkVSX1BPUlQKICAgICAgdGl0bGU6IFNlcnZlciBQb3J0CiAgICAgIHZhbHVlOiAiNDAwMCIK
ICAgICAgdHlwZTogaW50CiAgICAgIHJlcXVpcmVkOiB0cnVl"


COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb