FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG1vYmlsZS1jbGllbnQtc2VydmljZS1hcGIKZGVzY3JpcHRpb246\
IEFlcm9HZWFyIG1vYmlsZS1jbGllbnQtc2VydmljZSBTZXJ2ZXIgCmJpbmRhYmxlOiBUcnVlCmFz\
eW5jOiBvcHRpb25hbAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogTW9iaWxlIENsaWVudCBTZXJ2\
aWNlIDMKICBsb25nRGVzY3JpcHRpb246ICJBbiBBUEIgZGVwbG95aW5nIHRoZSBBZXJvR2VhciBt\
b2JpbGUtY2xpZW50LXNlcnZpY2UgU2VydmVyIHdpdGggcGVyc2lzdGVudCBzdG9yYWdlIGFuZCBh\
dXRoZW50aWNhdGlvbiB0aHJvdWdoIE9wZW5zaGlmdCIKICBpbWFnZVVybDogImh0dHBzOi8vcGJz\
LnR3aW1nLmNvbS9wcm9maWxlX2ltYWdlcy8xNzk0NDQwMDA1L2Flcm9nZWFyX2ljb24tMV80MDB4\
NDAwLnBuZyIKICBkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9kb2NzLmFlcm9nZWFyLm9yZy9l\
eHRlcm5hbC9hcGIvbW9iaWxlLWNsaWVudC1zZXJ2aWNlLmh0bWwiCiAgcHJvdmlkZXJEaXNwbGF5\
TmFtZTogIlJlZCBIYXQsIEluYy4iCiAgZGVwZW5kZW5jaWVzOiBbXQogIHNlcnZpY2VOYW1lOiBt\
b2JpbGUtY2xpZW50LXNlcnZpY2UKICBiaW5kaW5nc0xpbWl0OiAyCnBsYW5zOgogIC0gbmFtZTog\
ZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFBlcnNpc3RlbnQgZGVwbG95bWVudCBvZiBtb2JpbGUt\
Y2xpZW50LXNlcnZpY2UKICAgIGZyZWU6IFRydWUKICAgIHBhcmFtZXRlcnM6IFtdCg=="


COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb