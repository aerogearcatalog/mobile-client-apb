FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG1kYy1zZXJ2ZXItYXBiCmRlc2NyaXB0aW9uOiBBZXJvR2VhciBt\
ZGMtc2VydmVyIFNlcnZlciAKYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRh\
OgogIGRpc3BsYXlOYW1lOiBNb2JpbGUgRGV2ZWxvcGVyIENvbnNvbGUgIDIKICBsb25nRGVzY3Jp\
cHRpb246ICJBbiBBUEIgZGVwbG95aW5nIHRoZSBBZXJvR2VhciBtZGMtc2VydmVyIFNlcnZlciB3\
aXRoIHBlcnNpc3RlbnQgc3RvcmFnZSBhbmQgYXV0aGVudGljYXRpb24gdGhyb3VnaCBPcGVuc2hp\
ZnQiCiAgaW1hZ2VVcmw6ICJodHRwczovL3Bicy50d2ltZy5jb20vcHJvZmlsZV9pbWFnZXMvMTc5\
NDQ0MDAwNS9hZXJvZ2Vhcl9pY29uLTFfNDAweDQwMC5wbmciCiAgZG9jdW1lbnRhdGlvblVybDog\
Imh0dHBzOi8vZG9jcy5hZXJvZ2Vhci5vcmcvZXh0ZXJuYWwvYXBiL21kYy1zZXJ2ZXIuaHRtbCIK\
ICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKICBkZXBlbmRlbmNpZXM6IAog\
ICAgICAtICJkb2NrZXIuaW8vb3BlbnNoaWZ0L29hdXRoLXByb3h5OnYxLjEuMCIKICAgICAgLSAi\
ZG9ja2VyLmlvL3NhZ2FvZnRoZXJlYWxtcy9tb2JpbGUtY2xpZW50LXNlcnZpY2U6bGF0ZXN0Igog\
IHNlcnZpY2VOYW1lOiBtZGMtc2VydmVyCiAgYmluZGluZ3NMaW1pdDogMgpwbGFuczoKICAtIG5h\
bWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBQZXJzaXN0ZW50IGRlcGxveW1lbnQgb2YgbWRj\
LXNlcnZlcgogICAgZnJlZTogVHJ1ZQogICAgcGFyYW1ldGVyczogW10K"


COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb